Please refer to the code.
